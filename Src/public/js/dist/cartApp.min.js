angular.module("codeWithDan",["ngRoute","ngAnimate"]).config(function(t){t.when("/",{controller:"CartController",templateUrl:"/app/views/cart.html",controllerAs:"vm"}).when("/checkout",{controller:"CheckoutController",templateUrl:"/app/views/checkout.html",controllerAs:"vm"}).when("/completedOrder",{controller:"CompletedOrderController",templateUrl:"/app/views/completedOrder.html",controllerAs:"vm"}).otherwise({redirectTo:"/"})}),function(){var t=function(t){var e="/api/cart/";csrf=codeWithDan.csrf,service=this,service.getCart=function(){return t.get(e)},service.putCart=function(o){return t.put(e,{_csrf:csrf,cart:o})},service.applyDiscountCode=function(o){return t.post(e+"discountcode",{_csrf:csrf,discountCode:o})},service.checkout=function(o){return t.post(e+"checkout",{_csrf:csrf,cart:o})},service.completeOrder=function(o){return t.post(e+"completeOrder",{_csrf:csrf,checkoutData:o})},service.clearCart=function(){return t.post(e+"clear",{_csrf:csrf})}};t.$inject=["$http"],angular.module("codeWithDan").service("cartService",t)}(),function(){var t=function(t,e,o){function c(){codeWithDan.shoppingCart.updateValues(n.cart),n.cart&&n.cart.items&&n.cart.items.length?n.showDiscountCodeSection=!n.cart.discountCode&&!n.cart.itemHasDiscountCode:(n.showDiscountCodeSection=!1,n.showDiscountCode=!1,n.discountCode=null,n.discountCodeMessage=null,n.discountCodeClass=null)}var n=this;n.cart=null,n.showDiscountCodeSection=!1,n.showDiscountCode=!1,n.discountCode=null,n.discountCodeMessage=null,n.discountCodeClass=null,n.isCartEditable=!0,n.checkoutText="Check Out",n.displayDiscountCode=function(){n.showDiscountCode=!0},n.updateTotal=function(t){""!==t.quantity&&(t.quantity=parseInt(t.quantity),o.putCart(n.cart).then(function(t){n.cart=t.data.cart,c()},function(t){alert("Sorry, unable to update your cart due to an error.")}))},n.applyDiscountCode=function(){n.discountCode&&n.cart&&n.cart.items.length&&o.applyDiscountCode(n.discountCode).then(function(t){n.cart=t.data.cart,n.discountCodeMessage=t.data.discountCodeMessage,n.discountCodeClass=t.data.discountCodeStatus?"bg-success":"bg-danger",n.discountCode=""},function(t){n.discountCodeError="Sorry, unable to apply that discount code."})},n.checkout=function(){o.checkout(n.cart).then(function(o){o.data.isAuthenticated?e.path("/checkout"):t.location.href="/login"},function(){t.alert("Sorry, uanble to navigate to the checkout page due to an error.")})},o.getCart().then(function(t){n.cart=t.data.cart,c()},function(t){console.log(t)})};t.$inject=["$window","$location","cartService"],angular.module("codeWithDan").controller("CartController",t)}(),function(){var t=function(t,e){var o=this;o.cart=null,o.isCartEditable=!1,o.error=null,o.orderInProcess=!1,o.checkoutData={name:null,creditCardNumber:"4005 5192 0000 0004",expirationMonth:null,expirationYear:null,cvvCode:null},o.completeOrder=function(){o.orderInProcess=!0,e.completeOrder(o.checkoutData).then(function(e){e.data.transactionResult.success?(o.cart=e.data.cart,t.path("/completedOrder")):o.error="Oops - looks like a problem occurred: "+data.transactionResult.message},function(t){console.log(t)})},e.getCart().then(function(e){e.data.cart&&e.data.cart.items.length>0?o.cart=e.data.cart:t.path("/cart")},function(t){console.log(t)})};t.$inject=["$location","cartService"],angular.module("codeWithDan").controller("CheckoutController",t)}(),function(){var t=function(t){var e=this;e.cart=null,e.isCartEditable=!1,t.getCart().then(function(o){e.cart=o.data.cart,codeWithDan.shoppingCart.updateValues({total:0}),t.clearCart().then(function(t){})},function(t){console.log(t)})};t.$inject=["cartService"],angular.module("codeWithDan").controller("CompletedOrderController",t)}();