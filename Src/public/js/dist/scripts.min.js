var codeWithDan=codeWithDan||{};codeWithDan.shoppingCart=function(){return $(document).ready(function(){$(".cartItem").click(function(){var e=$(this),t=e.attr("data-productId"),n=e.attr("data-priceType"),i=e.attr("data-discountCode");$('.cartItem[data-productid="'+t+'"').each(function(){var e=$(this),t=e.attr("data-pricetype");t===n?(e.html("In Cart"),window.setTimeout(function(){location.href="/cart"},500)):t.indexOf("rent")>-1?e.html("Rent"):e.html("Buy")}),addToCart(t,1,n,i)}),$(".removeCartItem").click(function(){var e=$(this),t=e.attr("data-productId");removeFromCart(t)})}),addToCart=function(e,t,n,i){$.post("/api/cart",{productId:e,quantity:t,priceType:n,discountCode:i,_csrf:codeWithDan.csrf}).done(function(e){updateValues(e.cart)}).fail(function(e,t,n){alert(n.message)})},updateValues=function(e){e||(e={total:0}),$(".cartTotal").text("$"+e.total.toFixed(2))},{updateValues:updateValues}}();var codeWithDan=codeWithDan||{};!function(e){e(document).ready(function(){e("#searchButton").click(function(){var t=e("#searchText").val();""!==t&&(location.href="/search?searchtext="+t)}),e(".category-header").click(function(){var t=e(this).attr("data-categoryId");e('.category-container div[data-categoryId="'+t+'"]').slideToggle(200)}),codeWithDan.helpers.isMobile()&&e("#carousel-codewithdan").swiperight(function(){e(this).carousel("prev")}).swipeleft(function(){e(this).carousel("next")}),codeWithDan.helpers.isIE()&&e(".parallax").css("background-attachment","scroll");for(var t=["/img/background_manrocks_1920x500.jpg"],n=0,i=t.length;i>n;n++)e("<img />").attr("src",t[n])})}(jQuery),codeWithDan.helpers=function(){var e=function(){return null!=navigator.userAgent.match(/ipad|iphone|ipod|android|blackberry|webos|symbianos|silk|mobi/i)},t=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("msie")||-1!==navigator.userAgent.toLowerCase().indexOf("trident")};return{isMobile:e,isIE:t}}(),function(e){codeWithDan.helpers.isMobile()||codeWithDan.helpers.isIE()||(e(document).ready(function(){var t=e(window),n=[];e(".parallax").each(function(){n.push({item:e(this),speed:e(this).attr("data-speed")})}),t.scroll(function(){for(var e=0;e<n.length;e++){var i=n[e],o=i.item,a=i.speed?i.speed:5,r=-((t.scrollTop()-o.offset().top)/a),d="50% "+r+"px";o.css({backgroundPosition:d})}})}),document.createElement("article"),document.createElement("section"))}(jQuery),codeWithDan.videoManager=function(){var e,t,n,i,o,a,r="/api/progress/",d="?api=1&player_id=videoPlayer&color=547DFD",c=null,s=null,u=!1,l=null,f=codeWithDan.helpers.isMobile(),m=function(){e=$("#videoPlayer"),e.length&&(o=$("#modalVideo"),a=$("#modalVideoTitle"),f&&o.removeClass("fade"),v(),p())},v=function(){fakewaffle.responsiveTabs(["xs","sm"]),$(".module-title").click(function(){var e=$(this).attr("data-moduleId");$('.modules-container div[data-moduleId="'+e+'"]').slideToggle(100)}),$(".video-link").click(g),o.on("hide.bs.modal",function(e){t.api("unload")})},h=function(){t.api("getDuration",function(e){n=e}),t.addEvent("finish",function(e){k("finished")}),t.addEvent("play",function(e){x()}),t.addEvent("playProgress",function(e,t){c.currentVideoTime=e.seconds}),t.addEvent("pause",function(e){T(),k("setmarker")}),u&&(seekTo(),u=!1)},p=function(){var t=e.attr("data-productId");$.get(r,{productId:t},function(e){if(i=e,c=e.currentlyViewing)c.initialLoad=!0,y();else{var t=i.product.modules[0],n=t.sections[0];setCurrentlyViewing(t.moduleId,n.sectionId,n.videoUrl),I(!1,!1)}if(i.userProgress)for(var o=i.userProgress.completedSections,a=0;a<o.length;a++)markCompleted(o[a])})},g=function(){var e=$(this),t=e.attr("data-moduleId"),n=e.attr("data-sectionId"),i=getModuleAndSection(t,n).section.videoUrl,r=e.attr("data-videoTitle");c&&c.initialLoad?(c.initialLoad=!1,I(!0,!0)):(setCurrentlyViewing(t,n,i),I(!1,!0),k("setmarker")),a.html(r),o.modal("show")},I=function(n,i){e.attr("src",c.videoUrl+d),t||e.load(function(){t=$f(e[0]),t.addEvent("ready",h)}),u=n,y()},y=function(){s&&s.removeClass("currently-viewing-video"),s=$('div[data-sectionId="'+c.sectionId+'"]'),s.addClass("currently-viewing-video")},k=function(e){var t=c;t.action=e,$.post(r,{_csrf:codeWithDan.csrf,userProgress:t},function(t){"finished"===e&&(markCompleted(c.sectionId),moveToNextVideo())})},x=function(){l||(l=setInterval(function(){k("setmarker")},3e4))},T=function(){l&&(clearInterval(l),l=null)};return markCompleted=function(e){$('span[data-sectionId="'+e+'"]').addClass("fa-check")},seekTo=function(){if(c){var e=c.currentVideoTime-2;0>e&&(e=0),t.api("seekTo",e);var n=setTimeout(function(){clearTimeout(n)},500)}},moveToNextVideo=function(){var e=findNextSection();e?(I(!1,!0),k("setmarker")):T()},getModuleAndSection=function(e,t){var n=i.product.modules,o=itemIndex(n,"moduleId",e),a=itemIndex(n[o].sections,"sectionId",t);return{moduleIndex:o,module:n[o],sectionIndex:a,section:n[o].sections[a]}},findNextSection=function(){var e,t,n=getModuleAndSection(c.moduleId,c.sectionId),o=i.product.modules,a=n.moduleIndex,r=n.sectionIndex;return o[a].sections.length-1>r?(e=o[a],t=e.sections[r+1]):o.length-1>a&&(e=o[a+1],t=e.sections[0]),e&&t?(setCurrentlyViewing(e.moduleId,t.sectionId,t.videoUrl),{module:e,section:t}):null},setCurrentlyViewing=function(e,t,n,o){c={productId:i.product._id,moduleId:e,sectionId:t,videoUrl:n,currentVideoTime:o?o:0}},itemIndex=function(e,t,n){if(!e)return-1;var i;return i=t?e.map(function(e){return e[t].toString()}).indexOf(n):e.map(function(e){return e.toString()}).indexOf(n)},{init:m}}(),codeWithDan.isAuthenticated&&codeWithDan.videoManager.init(),codeWithDan.videoPreviewManager=function(){var e,t,n,i,o="?api=1&player_id=videoPlayer&color=547DFD",a=!1,r=codeWithDan.helpers.isMobile(),d=function(){e=$("#videoPlayer"),e.length&&(n=$("#modalVideo"),i=$("#modalVideoTitle"),r&&n.removeClass("fade"),c())},c=function(){$(".video-preview-link").click(u),n.on("hide.bs.modal",function(e){t.api("unload")})},s=function(){a&&(r||t.api("play"),a=!1)},u=function(){var r=$(this).attr("data-videourl")+o,d=$(this).attr("data-videoTitle");e.attr("src",r),a=!0,t||e.load(function(){t=$f(e[0]),t.addEvent("ready",s)}),i.html(d),n.modal("show")};return{init:d}}(),codeWithDan.videoPreviewManager.init();